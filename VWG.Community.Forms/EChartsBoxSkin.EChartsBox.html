<html xmlns="http://www.w3.org/1999/xhtml"  lang="Context.Language">
<head>
    <meta charset="utf-8">
    <title>EChartsBox Control</title>
    <script type="text/javascript" src="Resources.Includes.js.wgx"></script>
    <script type="text/javascript" src="Resources.Browser.Form.js.wgx"></script>
    <script type="text/javascript" src="Resources.Gizmox.WebGUI.Forms.Skins.CommonSkin.Interfaces.js.wgx"></script>
    <!-- 引入 echarts.js -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.2.1/dist/echarts.min.js"></script>
</head>
<body>
    <!-- 为 ECharts 准备一个具备大小（宽高）的 Dom -->
    <div id="main" style="width: 100%;height:100%;"></div>
    <script type="text/javascript">

        // Get applicaion and client API reference
        window.mobjApp = parent.mobjApp;
        window.vwgContext = parent.vwgContext;

        // Get TreantBox control id
        var strControlId = mobjApp.Web_GetQueryStringParam(document.location.href, "id");
        var objNode = mobjApp.Data_GetNode(strControlId);

        // 顯示 attributes 數量：default + TreantBox.RenderAttributes()
        console.log(strControlId + ": " + JSON.stringify(objNode.attributes));

        // 顯示 VWG Attributes: key value pairs
        var echartsOption = "";
        var strBackColor = "transparent";
        var strForeColor = "transparent";
        var strHtml = "";
        //
        for (i = 0; i < objNode.attributes.length; i++) {
            var attr = objNode.attributes[i];
            console.log(attr.nodeName + " = " + attr.nodeValue);

            switch (attr.nodeName) {
                case "Attr.Background":
                    strBackColor = attr.nodeValue;
                    break;
                case "Attr.Fore":
                    strForeColor = attr.nodeValue;
                    break;
                case "Attr.HTML5":
                    strHtml = attr.nodeValue;
                    break;
                case "ANYTHING":    // custom attribute (no leading Attr.)
                    anything = attr.nodeValue;
                    break;
                case "EChartsOption":
                    echartsOption = attr.nodeValue;
            }
        };

        // 根據 VWG Server side 提供嘅 ECharts option 做嘢
        getEChart(echartsOption);

        function getEChart(myOption) {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('main'));

            // 指定图表的配置项和数据
            var option = JSON.parse(myOption);

            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
        }
    </script>
</body>
</html>
